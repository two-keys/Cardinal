<nav id="nav">
  <ul>
    <li><a href="/">Home</a></li>
    <% if user_signed_in? %>
      <li class="disabled"><a href="/">Directory</a></li>
      <li>
        <%= turbo_stream_from dom_id(current_user)  + "_notifications" %>
        <% notifications = ChatUser.where(user: current_user, status: %i[unread unanswered ended]) %>
        <% unread_count = notifications.where(status: :unread).count %>
        <% unanswered_count = notifications.where(status: :unanswered).count %>
        <% ended_count = notifications.where(status: :ended).count %>
        <% notification_counts = { unread: unread_count, unanswered: unanswered_count, ended: ended_count } %>
        <%= render 'notifications', notifications: notification_counts %>
      </li>
      <li> <%= link_to current_user.username, edit_user_registration_path %> </li>
    <% else %>
      <li><a href= <%= new_user_session_path %>>Sign In</a></li>
      <li><a href= <%= new_user_registration_path %>>Sign Up</a></li>
    <% end %>
    <li class="disabled"><a href="/">Donate</a></li>
    <li class="disabled"><a href="/">Site Use</a></li>
    <li class="disabled"><a href="/">Discord</a></li>
    <% if user_signed_in? %>
      <li><%= button_to "Log Out", destroy_user_session_path, method: :delete %></li>
    <% end %>
    <% if Rails.env.development? %>
      <li id="online_count">
        <span><a href="#">Online: <%= ActionCable.server.pubsub.send(:redis_connection).pubsub("channels", "user_*_notifications").count %></a></span>
      </li>
    <% end %>
  </ul>
</nav>